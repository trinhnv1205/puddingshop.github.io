@page "/add-blog-post"
@using System.Net.Http.Json
@inject HttpClient Http
@inject NavigationManager Navigation

<PageTitle>Add Blog Post</PageTitle>

<h3>Add Blog Post</h3>

<EditForm Model="newPost" OnValidSubmit="HandleValidSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div>
        <label for="title">Title:</label>
        <InputText id="title" @bind-Value="newPost.Title" />
    </div>
    <div>
        <label for="content">Content:</label>
        <InputTextArea id="content" @bind-Value="newPost.Content" />
    </div>
    <button type="submit">Add Post</button>
</EditForm>

@code {
    private BlogPost newPost = new BlogPost();

    private async Task HandleValidSubmit()
    {
        var posts = await Http.GetFromJsonAsync<List<BlogPost>>("sample-data/blogposts.json");
        posts.Add(newPost);
        await Http.PostAsJsonAsync("sample-data/blogposts.json", posts);
        Navigation.NavigateTo("/");
    }

    public class BlogPost
    {
        public string Title { get; set; }
        public string Content { get; set; }
    }
}